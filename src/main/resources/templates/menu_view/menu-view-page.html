<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Menu Display</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <style>
        body {
            font-family: 'Roboto', sans-serif;
        }
        body, h1, h2, h3, p, ul, li {
            margin: 0;
            padding: 0;
        }
        /* Header styles */
        .header {
            background-color: transparent; /* 투명한 배경 */
            /*position: fixed;*/
            width: 100%;
        }

        /* Logo styles */
        .logo {
            position: absolute;
            top: 25px;
            left: 20px;
            color: #333333;
            font-size: 24px;
            font-weight: bold;
        }

        /* Menu styles */
        .menu {
            background-color: #ffffff; /* 헤더 바의 배경색 */
            padding: 30px 0; /* 높이를 높임 */
            border-bottom: 1px solid #e0e0e0;
            text-align: right;
        }

        .menu ul {
            list-style: none;
        }

        .menu ul li {
            display: inline-block;
            margin-right: 80px; /* 메뉴 간격을 조정 */
        }

        .menu ul li a {
            text-decoration: none;
            color: #333333;
            font-weight: bold;
        }
        /* Hover effect */
        .menu ul li a:hover {
            color: #009aff;
        }

        .store-title {
            background-color: transparent;
            width: 100%;
            padding: 10px 0;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin-top: 100px;
        }

        .menu-list {
            display: flex;
            justify-content: center;
            margin: 20px 0;
            overflow: hidden;
        }

        .menu-container {
            width: 100%;
        }

        .menu-item {
            display: inline-block;
            border: 1px solid #ddd;
            border-radius: 5px;
            width: 230px;
            text-align: center;
            margin: 10px; /* 좌우 간격을 조절하여 간격 설정 */
            padding: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }

        .menu-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .menu-item img {
            max-width: 100%;
            height: auto;
        }

        .menu-item h3 {
            font-size: 20px;
            margin: 10px 0;
        }

        .menu-item p {
            font-size: 16px;
            color: #777;
        }

        .menu-item button {
            display: inline-block;
            padding: 5px 10px;
            background-color: black;
            color: #ffffff;
            font-size: 13px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            float: right;
            margin-right: 3%;
        }

        .menu-item span {
            font-weight: bold;
            font-size: 18px;
            color: #333;
        }
        .main-banner {
            width: 100%;
            height: 30vh; /* 화면 높이를 100%로 설정 */
            overflow: hidden; /* 이미지가 벗어나는 부분을 숨김 */
        }

        .main-banner img {
            width: 100%;
            height: 100%; /* 이미지를 부모 요소에 맞게 확대 */
            object-fit: cover; /* 이미지가 잘릴 수 있도록 설정 */
        }

    </style>
</head>
<body>
<header class="header">
    <div class="logo">KioskEase Pro</div>
    <nav class="menu">
        <ul>
            <li><a href="http://localhost:8080/kiosk/create">Create Kiosk</a></li>
            <li><a href="http://localhost:8080/menu/">MY Store Menu</a></li>
            <li><a href="http://localhost:8080/menu/new">Create Kiosk Directory</a></li>
            <li><a href="#">Under development</a></li>
        </ul>
    </nav>
</header>



<div class="store-title">
    [ COFFEE SHOP ] 메뉴
</div>
<div class="menu-container" id="menu-container">
    <div class="menu-list" id="menu-list">
    </div>
</div>

<script>
    $(document).ready(function () {
        showStoreName();
        function showStoreName(store){
            let storeName = $(".store-title");

            let storeNameText = "[ 가게이름 ] 메뉴";

            storeNameText = storeNameText.replace("가게이름", store);

            storeName.text(storeNameText);
        }
        let currentIndex = 0;
        const itemsPerSlide = 4; // 한 번에 표시할 아이템 수

        function createMenuItems(menuData) {
            const menuList = $("#menu-list");
            menuList.empty();

            for (let i = 0; i < itemsPerSlide; i++) {
                const index = (currentIndex + i) % menuData.length; // 순환 인덱스 계산
                const menuItem = menuData[index];

                const itemDiv = $("<div>").addClass("menu-item");
                const itemImage = $("<img>").attr("src", menuItem.image).attr("alt", menuItem.name);
                const itemName = $("<h3>").text(menuItem.name);
                const itemPrice = $("<span>").text(`${menuItem.price}원`);
                const itemDescription = $("<p>").text(menuItem.description);
                const itemReplaceBtn = $("<button>").text("수정").data("menu-id",menuItem.id).attr("class","modify-btn");

                itemDiv.append(itemImage, itemName, itemPrice, itemDescription, itemReplaceBtn);
                menuList.append(itemDiv);
                itemDiv.hide().fadeIn(2000);
            }

            currentIndex = (currentIndex + itemsPerSlide) % menuData.length; // 다음 인덱스 설정
            function menuModifyBtnClickHandler() {
                const menuBtn = $(".modify-btn");

                menuBtn.on("click", function () {
                    const menuId = $(this).data("menu-id"); // 현재 클릭된 버튼의 데이터 가져오기
                    alert(menuId);
                });
            }
            menuModifyBtnClickHandler();
        }
        function displayMenuItems(data) {
            const menuItems = [];

            for (let i = 0; i < data.length; i++) {
                let id = data[i].id
                let name = data[i].name;
                let price = data[i].price;
                let description = data[i].description;
                let image = `/storeName/menuImage/${data[i].image}`; // 상대 경로로 변경

                const menuItem = {
                    id: id,
                    name: name,
                    price: price,
                    description: description,
                    image: image.replace("storeName", data[i].storeName)
                };
                menuItems.push(menuItem);
                // showStoreName(data[0].storeName); 정상 코드
                showStoreName("COFFEE SHOP")
            }

            return menuItems;
        }

        $.ajax({
            type: 'GET',
            url: '/menu/find-menu-list',
            dataType: 'json',
            success: function (data) {
                let menuData = displayMenuItems(data);
                createMenuItems(menuData);

                console.log(menuData);

                setInterval(function () {
                    $("#menu-list .menu-item").fadeOut(2000, function () {
                        createMenuItems(menuData);
                        $(this).remove();
                    });
                }, 7000);
            },
            error: function (error) {
                console.log('Ajax 요청 실패:', error);
            }
        });




    });


</script>

</body>
</html>
